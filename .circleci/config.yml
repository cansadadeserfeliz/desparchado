# This config was automatically generated from your source code
# Stacks detected: cicd:github-actions:.github/workflows,deps:python:.,file:manage.py:.
version: 2.1
orbs:
  python: circleci/python@2
jobs:
  test-be:
    # Install dependencies and run tests
    docker:
      - image: cimg/postgres:13.16-postgis
        environment:
          POSTGRES_USER: root
          POSTGRES_DB: desparchado_test
      - image: circleci/python:3.10
        environment:
          - DJANGO_SECRET_KEY=secret
          - DATABASE_NAME=desparchado_test
          - DATABASE_USER=root
          - DATABASE_PASSWORD=
          - DATABASE_HOST=localhost
          - DATABASE_PORT=5433
          - DJANGO_SETTINGS_MODULE='desparchado.settings.test'
    steps:
      - checkout
      - python/install-packages
      - run:
          name: Run tests
          command: python -m pytest
workflows:
  test:
    jobs:
      - test-be
