{% extends 'dashboard/layout/base.html' %}
{% load i18n crispy_forms_tags %}

{% block page_title %}{% translate 'Spreadsheet Sync' %}{% endblock %}
{% block page_subtitle %}{% translate 'Event Data Sync' %}{% endblock %}

{% block content %}
<div class="row">
  <div class="col-md-8">
    <div class="box">
      <div class="box-header with-border">
        <h3 class="box-title">{% translate 'Sincronizar eventos de una hoja de cÃ¡lculo' %}</h3>
      </div>
      <!-- /.box-header -->
      <div class="box-body">
        {% crispy form %}
      </div>
      <!-- /.box-body -->
    </div>
    <!-- /.box -->
  </div>
</div>
<!-- /.row -->

<div class="row mt-4">
  <div class="col-md-12">
    <div class="box">
      <div class="box-header with-border">
        <h3 class="box-title">{% translate 'Eventos sincronizados' %}</h3>
      </div>
      <div class="box-body">
        <div class="table-responsive">
          <table class="table table-hover table-condensed">
            <thead class="sticky-top">
              <tr>
                <th>{% translate 'Evento' %}</th>
                <th>{% translate 'Creado' %}</th>
                <th>{% translate 'Error' %}</th>
                <th>{% translate 'Advertencias' %}</th>
                <th>{% translate 'ID' %}</th>
                <th>{% translate 'Title' %}</th>
                <th>{% translate 'Date' %}</th>
                <th>{% translate 'Place' %}</th>
                <th>{% translate 'Category' %}</th>
                <th>{% translate 'Description' %}</th>
                <th>{% translate 'URL' %}</th>
                <th>{% translate 'Image URL' %}</th>
                <th>{% translate 'Organizers' %}</th>
                <th>{% translate 'Speakers' %}</th>
              </tr>
            </thead>
            <tbody>
            {% for event_data in synced_events_data %}
              <tr>
                <td>
                {% if event_data.event %}
                  <a href="{{ event_data.event.get_absolute_url }}" target="_blank" rel="noopener noreferrer">{{ event_data.event }}</a>
                {% else %}
                  {{ event_data.data.1 }}
                {% endif %}
                {% if event_data.event and event_data.event.source_id %}
                  // {{ event_data.event.source_id }}
                {% elif event_data.data.0 %}
                  // {{ event_data.data.0 }}
                {% endif %}
                </td>
                <td>
                {% if event_data.event %}
                  {% if event_data.created %}
                    <span class="badge bg-success-lt">{% translate 'Creado' %}</span>
                  {% else %}
                    <span class="badge bg-success-lt">{% translate 'Actualizado' %}</span>
                  {% endif %}
                {% else %}
                  <span class="badge bg-danger-lt">{% translate 'Error' %}</span>
                {% endif %}
                </td>
                <td  class="text-red">{{ event_data.error }}</td>
                <td class="text-yellow">{{ event_data.warnings|join:" // " }}</td>
                <td>{{ event_data.data.0 }}</td>
                <td>{{ event_data.data.1 }}</td>
                <td>{{ event_data.data.2 }}</td>
                <td>{{ event_data.data.3 }}</td>
                <td>{{ event_data.data.4 }}</td>
                <td>{{ event_data.data.5 }}</td>
                <td>{{ event_data.data.6 }}</td>
                <td>
                  <img alt="Image" height="120" src="{{ event_data.data.7 }}" />
                </td>
                <td>{{ event_data.data.8 }}</td>
                <td>{{ event_data.data.9 }}</td>
              </tr>
            {% endfor %}
            </tbody>
          </table>
        </div>
      </div>
    </div>
    <!-- /.box -->
  </div>
</div>
<!-- /.row -->

{% endblock content %}

{% block javascript %}
  {{ form.media }}
{% endblock javascript %}
