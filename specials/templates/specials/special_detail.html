{% extends 'layout/base.html' %}
{% load i18n static paginator_tags desparchado_tags django_vite %}

{% block title %}{{ special.title }} en Desparchado.co{% endblock %}

{% block bootstrap_css %}{% endblock %}

{% block extra_scripts %}
  {% vite_asset 'desparchado/frontend/scripts/event-details.ts' %}
{% endblock extra_scripts %}


{% block meta %}
  <meta property="og:title" content="{{ special.title }} en Desparchado.co">
  <meta property="og:description" content="{{ special.subtitle }}">
  <meta property="og:image" content="https://desparchado.co{{ special.get_image_url }}">

  <meta name="twitter:title" content="{{ special.subtitle }} en Desparchado.co">
  <meta name="twitter:description" content="{{ special.subtitle }}">
{% endblock %}

{% block content %}
  <div class="event-details__additional event-details__additional--main-image" aria-hidden="true" role="presentation">
    <div class="event-details__additional-children event-details__specials">
      <div class="event-details__special-item">
        <a class="event-details__special-banner-anchor">
          <img class="event-details__special-banner" src="{{ special.get_image_url }}" aria-hidden="true" role="presentation">
        </a>
      </div>
    </div>
  </div>

  <section class="event-details">
    <div class="event-details__container">
      <div class="event-details__details">
        <div class="event-details__header">
          <div class="event-details__title-section">
            <div>
              <p class="event-details__title text-heading-3">{{ special.title }}</p>
              <p class="event-details__title text-heading-5">{{ special.subtitle }}</p>
            </div>
          </div>
        </div>
        <div class="event-details__content">
          <div class="text-body-md event-details__description">
            <span class="text-body-md text-bold">
              {% translate 'Sobre el evento' %}:
              <br />
            </span>
            {{ special.description|safe }}
          </div>
        </div>
      </div>
      <div class="event-details__actions event-details__actions--custom-size excluded-from-mobile">
      </div>
    </div>
  </section>

  <section class="event-details__event-list">
    <div class="event-details__event-list-actions">
      <p class="event-details__title text-heading-1">{% translate 'Agéndate' %}</p>
      <form id="event_search_form" method="get" action="{{ request.path }}">
        <div class="event-details__event-list-search">
          <input class="text-input" type="text" name="q" placeholder="Buscar eventos..." value="{{ search_string }}">
          <div
            class="event-details__filter-action-item"
            data-vue-component="button"
            data-vue-prop-type="secondary"
            data-vue-prop-padding="condensed"
            data-vue-prop-label="{% translate 'Buscar' %}"
            data-vue-prop-is-action-submit="true"
          >
          </div>
          <div
              class="events-section__filter-action-item"
              data-vue-component="button"
              data-vue-prop-type="secondary"
              data-vue-prop-padding="condensed"
              data-vue-prop-label="{% translate 'Limpiar búsqueda' %}"
              data-vue-prop-link="{{ request.path }}"
            >
          </div>
        </div>
      </form>
      <div class="chip-group">
      {% for event_date in event_dates %}
        <a class="chip {% if event_date == selected_date %}chip--selected{% endif %}" role="button" href="?{{ selected_date_param }}={{ event_date|date:"Y-m-d" }}">
          {{ event_date|date:'D, b j' }}{% if today.year != event_date.year %} {{ event_date|date:'Y' }}{% endif %}
        </a>
      {% endfor %}
      </div>
    </div>

    <section class="container justify-content-center">
      {% get_simple_pagination %}
    </section>

    {% for event in events %}
      <div
        data-vue-component="event-card-full-width"
        data-vue-prop-tag="div"
        data-vue-prop-location="{{ event.place.name }}"
        data-vue-prop-description="{{ event.description }}"
        data-vue-prop-title="{{ event.title }}"
        data-vue-prop-day="{{ event.event_date|date:'j M' }}"
        data-vue-prop-time="{{ event.event_date|date:'H:i' }}"
        data-vue-prop-image-url="{{ event.get_image_url }}"
        data-vue-prop-link="{{ event.get_absolute_url }}"
        data-vue-prop-date-copy="{{ event.event_date|date:'l' }}"
        data-vue-prop-speakers='[{% with speakers=event.speakers.all %}{% if speakers %}{% for speaker in speakers %}{"imageUrl": "{{ speaker.get_image_url|escapejs }}", "link": "{{ speaker.get_absolute_url|escapejs }}", "name": "{{ speaker.name|escapejs }}" }{% if not forloop.last %}, {% endif %}{% endfor %}{% endif %}{% endwith %}]'
      >
      </div>
    {% empty %}
      <div class="events-section__empty text-heading-5">
        <p>{% translate 'No encontramos resultados para su búsqueda' %}</p>
        <a href="{{ request.path }}">{% translate 'Limpiar búsqueda' %}</a>
      </div>
    {% endfor %}

  </section>

{% endblock content %}
